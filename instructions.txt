trying to compile libGint with hip inside (hip) cp2k for Mi300a

(0) prepare yourself. The makefile is woefully un ready

# I could only find instructions on how to create a static lib using hipcc from a single file
# I could not get hipcc to use more than one file
# In particular, the linker lld was failing to find a (device) function defined in another file
# e.g compute_Fm.cpp needs compute_pbc, defined in util.cpp and lld was not finding it
# There should be a way to pass L options to lld, but could not find it

(1) combine all cpp files in src into a single file : single.cpp

(1.5) fix single.cpp, remove all double definitions and other problems

(2) hipcc --emit-static-lib single.cpp -g -fPIC -fPIE --offload-arch=gfx942 --std=c++17 -I'/opt/rocm-6.4.0/include' -I'/opt/rocm-6.4.0/include/hipblas' -o single.a

# This also creates libgint.mod, since interface_libgint.F90 contains the libgint module.
# I don't remember why I made this way ...
# ALSO it is probably missing either -fopenmp or -lgomp
# I am too scared to recompile cp2k, it took a long time to get cp2k compile and link

(3) gfortran src/interface_libgint.F90 -fPIC -fPIE -c -o interface_libgint.o

(4) ar rcsD interface_libgint.a interface_libgint.o 

# Apparently ar merged.a lib1.a lib2.a does not always merge the libraries, so we do it very explicitly by passing a script to ar
(5) create a file called lib_add.mri containing:

create libcp2kGint.a
addlib single.a
addlib interface_libgint.a
save
end

(5.5) ar -M lib_add.mri

# We copy the library and mod where cp2k expect to find. Not totally sure about .mod, but this works

(6) cp libcp2kGint.a /tools/toolchain/install/libGint-EXP/lib/libcp2kGint.a

(7) cp libgint.mod /tools/toolchain/install/libGint-EXP/include/libgint.mod 









